import{B as M}from"./Back-48913a87.js";import{T as S,C as V}from"./CopyText-2552fec1.js";import{_ as R,h as H,g as q,i as x,r as z,R as F,b as L,G as P,o as c,c as u,d as t,f as _,H as G,B as w,l as s,t as a,L as j,z as T,A as b,y as g,F as J,k,E as K,I as C,q as I,m as $,x as O,p as E,a1 as Q}from"./index-04627e7a.js";/* empty css                                                          */import{e as W}from"./ethers-28ada4bc.js";import"./SelectLockDate-98dc4e80.js";/* empty css                                                                */import"./DoubleToken-3c1fd872.js";import{_ as X}from"./Index-d0aed021.js";import{f as A}from"./units-d53ad2e9.js";import"./TokenIcon-10248b9f.js";import"./OperateSuccessDialog-05de8314.js";const Z={class:"token-detail"},ee={class:"content"},te={key:0},oe={class:"top"},se={class:"right"},ae={class:"lock-date"},le={class:"left"},ne={class:"right"},ie={class:"left"},ce={class:"right"},de={key:0},re={class:"left"},me={class:"right"},ke={class:"left"},pe={class:"right"},ue={key:0,class:"value"},_e={key:1,class:"value"},ye={class:"left"},he={class:"right"},fe={class:"unlock-date"},we={class:"left"},ge={class:"right"},ve={key:1,class:"operate"},Le={__name:"Detail",props:{lockId:String,tokenType:String},setup(N){const i=N,y=H(),{t:B}=q(),h=x(!1);x(!1);const v=x(!1),e=z({id:i.lockId,address:"",amountString:"",tokenList:[],lockDate:0,unlockDate:0,isLpToken:!1,symbol:"",chain:"",isExpired:!1,chainCoinSymbol:"",decimals:0});async function U(){h.value=!1;let l;i.tokenType=="lpTokenV3"?l=await k.wallet.metamask.contractTokenLockV3(y.lock.tokenLockV3Address):l=await k.wallet.metamask.contractTokenLockV2(y.lock.tokenLockV2Address);let n;try{console.log(i.lockId),n=await l.getLockById(i.lockId)}catch{K({message:B("failedToGetDetail"),type:"error"});return}if(e.lockDate=Number(n[4]),e.unlockDate=Number(n[5]),e.tokenId=n.tokenId,e.address=n[1],e.owner=n[2],e.isExpired=C().unix()>=e.unlockDate,e.chain=y.chain,e.chainCoinSymbol=y.chainCoinSymbol,i.tokenType=="lpToken")try{const o=await k.wallet.metamask.contractLP(e.address);let d=await o.decimals();e.decimals=d;let r=await o.token0(),p=await(await k.wallet.metamask.contractERC20(r)).symbol(),m=await o.token1(),f=await(await k.wallet.metamask.contractERC20(m)).symbol();e.isLpToken=!0,e.tokenList[0]={symbol:p.toUpperCase(),address:r.toLowerCase()},e.tokenList[1]={symbol:f.toUpperCase(),address:m.toLowerCase()},e.amountString=A(n[3],d),e.symbol=`${p}/${f}`}catch(o){console.log(o)}else if(i.tokenType=="token")try{const o=await k.wallet.metamask.contractERC20(e.address);let d=await o.symbol(),r=await o.decimals();e.decimals=r,e.tokenList=[],e.isLpToken=!1,e.symbol=d.toUpperCase(),e.amountString=A(n[3],r)}catch(o){console.log(o)}else if(i.tokenType=="lpTokenV3")try{let d=await(await k.wallet.metamask.contractNFT(e.address)).positions(e.tokenId);console.log(d.token0);let r=d.token0,p=await(await k.wallet.metamask.contractERC20(r)).symbol(),m=d.token1,f=await(await k.wallet.metamask.contractERC20(m)).symbol();e.isLpToken=!0,e.tokenList[0]={symbol:p.toUpperCase(),address:r.toLowerCase()},e.tokenList[1]={symbol:f.toUpperCase(),address:m.toLowerCase()},e.liquidity=d.liquidity,e.symbol=`${p}/${f}`}catch(o){console.log(o)}console.log(e),h.value=!0}return F(()=>{U()}),(l,n)=>{const o=L("el-tag"),d=L("EditPen"),r=L("el-icon"),D=L("el-button"),p=P("loading");return c(),u(J,null,[t("div",Z,[_(M),G((c(),u("div",ee,[h.value?(c(),u("ul",te,[t("li",oe,[i.tokenType=="token"?(c(),w(S,{key:0,class:"token-name",name:e.symbol,bigIcon:s(I)(e.chain,e.address.toLocaleLowerCase()),smallIcon:s($)(e.chain)},null,8,["name","bigIcon","smallIcon"])):(c(),w(S,{key:1,class:"token-name",name:e.symbol,token1:s(I)(e.chain,e.tokenList[0].address.toLocaleLowerCase()),token2:s(I)(e.chain,e.tokenList[1].address.toLocaleLowerCase())},null,8,["name","token1","token2"])),t("div",se,[t("span",ae,a(l.$t("unlockTime2"))+"ï¼š"+a(s(C).unix(e.lockDate).format("YYYY-MM-DD HH:mm:ss")),1)])]),t("li",null,[t("div",le,a(l.$t("contractChian")),1),t("div",ne,[_(j,{icon:s($)(e.chain),text:s(O).chainList.find(m=>m.chain==e.chain.toLowerCase()).chainShow},null,8,["icon","text"])])]),t("li",null,[t("div",ie,a(l.$t("contractAddress")),1),t("div",ce,[_(V,{smallText:s(E)(e.address),text:e.address},null,8,["smallText","text"])])]),i.tokenType=="lpTokenV3"?(c(),u("li",de,[t("div",re,a(l.$t("tokenID")),1),t("div",me,a(e.id),1)])):T("",!0),t("li",null,[t("div",ke,a(l.$t("lockNumber")),1),t("div",pe,[i.tokenType=="lpTokenV3"?(c(),u("div",ue,a(s(W).formatEther(e.liquidity.toString())),1)):(c(),u("div",_e,a(e.amountString),1))])]),t("li",null,[t("div",ye,a(l.$t("unlockTime2")),1),t("div",he,[t("div",fe,[b(a(s(C).unix(e.unlockDate).format("YYYY-MM-DD HH:mm:ss"))+" ",1),e.isExpired?(c(),w(o,{key:0,class:"over-time tag",size:"small",type:"info"},{default:g(()=>[b(a(l.$t("expired")),1)]),_:1})):(c(),w(o,{key:1,class:"progress tag",size:"small",type:"info"},{default:g(()=>[b(a(l.$t("dayLeft",{day:s(Q)(s(C).unix(e.unlockDate).toDate())})),1)]),_:1}))])])]),t("li",null,[t("div",we,a(l.$t("lockUser")),1),t("div",ge,[_(V,{smallText:s(E)(e.owner),text:e.owner},null,8,["smallText","text"])])])])):T("",!0),!e.isExpired&&h.value&&s(y).walletAddress&&e.owner.toLowerCase()==s(y).walletAddress.toLowerCase()?(c(),u("div",ve,[_(D,{class:"btn",text:"",bg:"",type:"primary",onClick:n[0]||(n[0]=m=>v.value=!0)},{icon:g(()=>[_(r,{style:{"font-size":"16px"}},{default:g(()=>[_(d)]),_:1})]),default:g(()=>[b(" "+a(l.$t("edit")),1)]),_:1})])):T("",!0)])),[[p,!h.value]])]),v.value?(c(),w(X,{key:0,modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=m=>v.value=m),lockId:e.id,isLockV2:i.tokenType!=="lpTokenV3",isLpToken:i.tokenType!=="token",unlockDate:e.unlockDate,tokenList:e.tokenList,symbol:e.symbol,address:e.address,amountString:e.amountString,chain:e.chain,decimals:e.decimals},null,8,["modelValue","lockId","isLockV2","isLpToken","unlockDate","tokenList","symbol","address","amountString","chain","decimals"])):T("",!0)],64)}}},Be=R(Le,[["__scopeId","data-v-5f871002"]]);export{Be as default};
