import{B as R}from"./Back-202bda37.js";import{T as x,C as E}from"./CopyText-6d95ee88.js";import{_ as q,j as H,i as F,r as S,g as P,T as j,a as L,I as z,o as i,c as h,b as t,d as k,J as G,B as f,p as c,t as l,N as J,A as T,e as b,w as p,F as K,m,E as O,K as I,v as $,q as A,s as N,a1 as Q}from"./index-6217c161.js";import{_ as W}from"./Index-c2c00fca.js";import{_ as X}from"./Index-73889481.js";import{e as Z}from"./ethers-5ff326a4.js";import{f as U}from"./units-b1f53ef7.js";import"./TokenIcon-6f670ab0.js";import"./TokenIcon.vuevuetypestyleindex0scopedc700f23blang-01358ba7.js";import"./DoubleToken-022adc77.js";import"./OperateSuccessDialog-a89f4189.js";import"./SelectLockDate-9ce1d67c.js";import"./InputLockNumber-e85540f2.js";/* empty css                                                                */const ee={class:"token-detail"},te={class:"content"},oe={key:0},se={class:"top"},ae={class:"right"},le={class:"lock-date"},ne={class:"left"},ie={class:"right"},ce={class:"left"},de={class:"right"},re={key:0},ke={class:"left"},me={class:"right"},pe={class:"left"},ue={class:"right"},ye={key:0,class:"value"},_e={key:1,class:"value"},he={class:"left"},fe={class:"right"},ge={class:"unlock-date"},Te={class:"left"},ve={class:"right"},we={key:1,class:"operate"},Le={__name:"Detail",props:{lockId:String,tokenType:String},setup(B){const a=B,g=H(),{t:Y}=F(),v=S(!1),C=S(!1),D=S(!1),e=P({id:a.lockId,address:"",amountString:"",tokenList:[],lockDate:0,unlockDate:0,isLpToken:!1,symbol:"",chain:"",isExpired:!1,chainCoinSymbol:"",decimals:0});async function M(){v.value=!1;let n;a.tokenType=="lpTokenV3"?n=await m.wallet.metamask.contractTokenLockV3(g.lock.tokenLockV3Address):n=await m.wallet.metamask.contractTokenLockV2(g.lock.tokenLockV2Address);let o;try{console.log(a.lockId),o=await n.getLockById(a.lockId)}catch{O({message:Y("failedToGetDetail"),type:"error"});return}if(e.lockDate=Number(o[4]),e.unlockDate=Number(o[5]),e.tokenId=o.tokenId,e.address=o[1],e.owner=o[2],e.isExpired=I().unix()>=e.unlockDate,e.chain=g.chain,e.chainCoinSymbol=g.chainCoinSymbol,a.tokenType=="lpToken")try{const s=await m.wallet.metamask.contractLP(e.address);let d=await s.decimals();e.decimals=d;let r=await s.token0(),u=await(await m.wallet.metamask.contractERC20(r)).symbol(),y=await s.token1(),w=await(await m.wallet.metamask.contractERC20(y)).symbol();e.isLpToken=!0,e.tokenList[0]={symbol:u.toUpperCase(),address:r.toLowerCase()},e.tokenList[1]={symbol:w.toUpperCase(),address:y.toLowerCase()},e.amountString=U(o[3],d),e.symbol=`${u}/${w}`}catch(s){console.log(s)}else if(a.tokenType=="token")try{const s=await m.wallet.metamask.contractERC20(e.address);let d=await s.symbol(),r=await s.decimals();e.decimals=r,e.tokenList=[],e.isLpToken=!1,e.symbol=d.toUpperCase(),e.amountString=U(o[3],r)}catch(s){console.log(s)}else if(a.tokenType=="lpTokenV3")try{let d=await(await m.wallet.metamask.contractNFT(e.address)).positions(e.tokenId);console.log(d.token0);let r=d.token0,u=await(await m.wallet.metamask.contractERC20(r)).symbol(),y=d.token1,w=await(await m.wallet.metamask.contractERC20(y)).symbol();e.isLpToken=!0,e.tokenList[0]={symbol:u.toUpperCase(),address:r.toLowerCase()},e.tokenList[1]={symbol:w.toUpperCase(),address:y.toLowerCase()},e.liquidity=d.liquidity,e.symbol=`${u}/${w}`}catch(s){console.log(s)}console.log(e),v.value=!0}return j(()=>{M()}),(n,o)=>{const s=L("el-tag"),d=L("CirclePlus"),r=L("el-icon"),V=L("el-button"),u=L("Timer"),y=z("loading");return i(),h(K,null,[t("div",ee,[k(R),G((i(),h("div",te,[v.value?(i(),h("ul",oe,[t("li",se,[a.tokenType=="token"?(i(),f(x,{key:0,class:"token-name",name:e.symbol,bigIcon:c($)(e.chain,e.address.toLocaleLowerCase()),smallIcon:c(A)(e.chain)},null,8,["name","bigIcon","smallIcon"])):(i(),f(x,{key:1,class:"token-name",name:e.symbol,token1:c($)(e.chain,e.tokenList[0].address.toLocaleLowerCase()),token2:c($)(e.chain,e.tokenList[1].address.toLocaleLowerCase())},null,8,["name","token1","token2"])),t("div",ae,[t("span",le,l(n.$t("unlockTime2"))+"ï¼š"+l(c(I).unix(e.lockDate).format("YYYY-MM-DD HH:mm:ss")),1)])]),t("li",null,[t("div",ne,l(n.$t("contractChian")),1),t("div",ie,[k(J,{icon:c(A)(e.chain),text:e.chain.toUpperCase()},null,8,["icon","text"])])]),t("li",null,[t("div",ce,l(n.$t("contractAddress")),1),t("div",de,[k(E,{smallText:c(N)(e.address),text:e.address},null,8,["smallText","text"])])]),a.tokenType=="lpTokenV3"?(i(),h("li",re,[t("div",ke,l(n.$t("tokenID")),1),t("div",me,l(e.id),1)])):T("",!0),t("li",null,[t("div",pe,l(n.$t("lockNumber")),1),t("div",ue,[a.tokenType=="lpTokenV3"?(i(),h("div",ye,l(c(Z).formatEther(e.liquidity.toString())),1)):(i(),h("div",_e,l(e.amountString),1))])]),t("li",null,[t("div",he,l(n.$t("unlockTime2")),1),t("div",fe,[t("div",ge,[b(l(c(I).unix(e.unlockDate).format("YYYY-MM-DD HH:mm:ss"))+" ",1),e.isExpired?(i(),f(s,{key:0,class:"over-time tag",size:"small",type:"info"},{default:p(()=>[b(l(n.$t("expired")),1)]),_:1})):(i(),f(s,{key:1,class:"progress tag",size:"small",type:"info"},{default:p(()=>[b(l(n.$t("dayLeft",{day:c(Q)(c(I).unix(e.unlockDate).toDate())}))+" }}",1)]),_:1}))])])]),t("li",null,[t("div",Te,l(n.$t("lockUser")),1),t("div",ve,[k(E,{smallText:c(N)(e.owner),text:e.owner},null,8,["smallText","text"])])])])):T("",!0),!e.isExpired&&v.value&&c(g).walletAddress&&e.owner.toLowerCase()==c(g).walletAddress.toLowerCase()?(i(),h("div",we,[k(V,{class:"btn",text:"",bg:"",type:"primary",onClick:o[0]||(o[0]=_=>D.value=!0)},{icon:p(()=>[k(r,null,{default:p(()=>[k(d)]),_:1})]),default:p(()=>[b(" "+l(n.$t("delay")),1)]),_:1}),a.tokenType=="token"||a.tokenType=="lpToken"?(i(),f(V,{key:0,class:"btn",text:"",bg:"",type:"primary",onClick:o[1]||(o[1]=_=>C.value=!0)},{icon:p(()=>[k(r,null,{default:p(()=>[k(u)]),_:1})]),default:p(()=>[b(" "+l(n.$t("appendLock")),1)]),_:1})):T("",!0)])):T("",!0)])),[[y,!v.value]])]),C.value?(i(),f(W,{key:0,modelValue:C.value,"onUpdate:modelValue":o[2]||(o[2]=_=>C.value=_),lockId:e.id,isLockV2:a.tokenType!=="lpTokenV3",isLpToken:a.tokenType!=="token",unlockDate:e.unlockDate,tokenList:e.tokenList,symbol:e.symbol,address:e.address,amountString:e.amountString,chain:e.chain,decimals:e.decimals},null,8,["modelValue","lockId","isLockV2","isLpToken","unlockDate","tokenList","symbol","address","amountString","chain","decimals"])):T("",!0),D.value?(i(),f(X,{key:1,modelValue:D.value,"onUpdate:modelValue":o[3]||(o[3]=_=>D.value=_),lockId:e.id,isLockV2:a.tokenType!=="lpTokenV3",isLpToken:a.tokenType!=="token",unlockDate:e.unlockDate,tokenList:e.tokenList,symbol:e.symbol,address:e.address,amountString:e.amountString,chain:e.chain,decimals:e.decimals},null,8,["modelValue","lockId","isLockV2","isLpToken","unlockDate","tokenList","symbol","address","amountString","chain","decimals"])):T("",!0)],64)}}},Me=q(Le,[["__scopeId","data-v-60605a6d"]]);export{Me as default};
