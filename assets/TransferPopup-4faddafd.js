import{_ as j,d as q,a5 as z,u as J,g as m,B,G as W,r as H,o as $,c as L,a as d,l as O,b as e,t,T as U,j as l,y as F,A as f,q as M,z as K,a4 as eo,I as Z,F as Q,s as V,p as x,n as k,J as so}from"./index-66fccc80.js";import{S as no}from"./SelectDate-88052b64.js";import{O as X}from"./OperateSuccessDialog-c87d34ba.js";import{e as to}from"./ethers-1c7de5fd.js";import{B as R}from"./bignumber-3e8dfdf6.js";import{a as oo,f as lo,b as G}from"./units-ac5af918.js";const co={class:"ave-popup"},io={class:"title"},uo={class:"body"},ro={key:0,class:"info"},ko={class:"key"},vo={class:"value"},ho={key:0,class:"token"},wo={key:1,class:"token"},mo={class:"key"},po={class:"value"},_o={class:"blue-font"},fo={class:"key"},yo={class:"value"},go={class:"key"},bo={class:"value"},$o={class:"select-date"},Lo={class:"key"},So={key:1,class:"change-amount"},Co={class:"key"},Io={__name:"EditPopup",props:{show:Boolean,lockId:String,isLockV2:Boolean,isLpToken:Boolean,unlockDate:Number,tokenList:Array,symbol:String,address:String,chainCoinSymbol:String,amountString:String,chain:String,decimals:Number},emits:["update:show","success"],setup(T,{emit:v}){const o=T,S=q(),C=z(),{t:p}=J(),a=m(0n),_=m(B.unix(o.unlockDate).toDate()),c=m(o.amountString),A=m(""),N=m(""),E=m(!1),P=m("");async function h(){const r=await(await k.wallet.contractERC20(o.address)).balanceOf(S.walletAddress);A.value=lo(r,o.decimals),console.log("value:"+A.value),r==0n&&(V(p("balanceSlow")),v("update:show",!1))}async function s(){console.log("estimateGas");const i=B.unix(o.unlockDate).add(1,"day").unix(),r=await k.wallet.getGasPrice(),b=await k.wallet.getBalance(S.walletAddress);console.log("balance",b);let w;if(o.isLockV2){const D=await k.wallet.contractTokenLockV2(C.tokenLockV2Address),Y=await(await k.wallet.contractERC20(o.address)).decimals(),ao=oo(o.amountString,Y);if(a.value=await D.editFee(),b<a.value){V(p("balanceSlow2",{chainMianCoin:S.chainCoinSymbol,amount:G(a.value)})),v("update:show",!1);return}w=await D.editLock.estimateGas(o.lockId,ao.toString(),i,{value:a.value})}else{const D=await k.wallet.contractTokenLockV3(C.tokenLockV3Address);if(a.value=await D.editFee(),b<a.value){V(p("balanceSlow2",{chainMianCoin:S.chainCoinSymbol,amount:G(a.value)})),v("update:show",!1);return}w=await D.editLock.estimateGas(o.lockId,i,{value:a.value})}console.dir(w),N.value=G(w*r).toString(),console.log(N.value)}function n(){(R(c.value).lt(o.amountString)||!c.value)&&(c.value=o.amountString)}async function u(){if(!_.value){V(p("selectUnlockTime"));return}if(R(c.value).lt(o.amountString)||!c.value){V(p("newLockedAmountLimit"));return}if(R(c.value).minus(o.amountString).gt(R(A.value))){V(o.symbol+p("balanceSlow"));return}const i=x({message:"Loading...",forbidClick:!0,duration:0}),r=B(_.value).unix();if(o.isLockV2){const b=await k.wallet.contractTokenLockV2(C.tokenLockV2Address);try{const D=await(await k.wallet.contractERC20(o.address)).decimals(),I=oo(c.value,D);a.value=await b.editFee();let Y=await b.editLock(o.lockId.toString(),I.toString(),r,{value:a.value});console.dir(Y),P.value=Y.hash,await Y.wait(),E.value=!0}catch(w){console.log(w)}finally{i.close()}}else{const b=await k.wallet.contractTokenLockV3(C.tokenLockV3Address);try{a.value=await b.editFee();let w=await b.editLock(o.lockId.toString(),r,{value:a.value});console.dir(w),P.value=w.hash,await w.wait(),E.value=!0}catch(w){console.log(w)}finally{i.close()}}}async function y(){const i=x({message:"Loading...",forbidClick:!0,duration:0});_.value=B.unix(o.unlockDate).add(1,"day").endOf("day").toDate(),c.value=o.amountString,await h(),await s(),i.close()}W(()=>o.show,(i,r)=>{i&&y()});function g(){v("update:show",!1),v("success")}return(i,r)=>{const b=H("van-field"),w=H("van-button"),D=H("van-popup");return $(),L(Q,null,[d(D,{show:T.show,"onUpdate:show":r[2]||(r[2]=I=>{v("update:show",I)}),round:"",closeable:"",position:"bottom"},{default:O(()=>[e("div",co,[e("div",io,t(i.$t("editLock")),1),e("div",uo,[o.chain?($(),L("ul",ro,[e("li",null,[e("div",ko,t(i.$t("lockAssets")),1),e("div",vo,[o.isLpToken?($(),L("div",ho,[d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),f(" "+t(`${o.symbol} (${l(M)(o.address)})`),1)])):($(),L("div",wo,[d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.address),chainIcon:l(K)(o.chain)},null,8,["tokenIcon","chainIcon"]),f(" "+t(`${o.symbol} (${l(M)(o.address)})`),1)]))])]),e("li",null,[e("div",mo,t(i.$t("unlockTime")),1),e("div",po,[e("span",null,t(l(B).unix(o.unlockDate).format("YYYY-MM-DD HH:mm:ss")),1),e("span",null,[f("("),e("span",_o,t(i.$t("dayLeft",{day:l(eo)(l(B).unix(o.unlockDate).toDate())})),1),f(")")])])]),e("li",null,[e("div",fo,t(i.$t("editFee")),1),e("div",yo,t(`${a.value?l(to).formatEther(a.value):"--"} ${o.chainCoinSymbol}`),1)]),e("li",null,[e("div",go,t(i.$t("gas")),1),e("div",bo,t(`${N.value?N.value:"--"} ${o.chainCoinSymbol}`),1)])])):Z("",!0),e("div",$o,[e("div",Lo,t(i.$t("setDelayDate")),1),d(no,{date:_.value,"onUpdate:date":r[0]||(r[0]=I=>_.value=I),"min-date":l(B).unix(o.unlockDate).add(1,"day").endOf("day").toDate()},null,8,["date","min-date"])]),o.isLockV2?($(),L("div",So,[e("div",Co,t(i.$t("newLockedAmount")),1),d(b,{class:"amount",type:"number",modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=I=>c.value=I),onBlur:n,placeholder:i.$t("pleaseEnter")},null,8,["modelValue","placeholder"])])):Z("",!0),d(w,{class:"btn",type:"primary",block:"",onClick:u},{default:O(()=>[f(t(i.$t("confirmAndLock")),1)]),_:1})])])]),_:1},8,["show"]),d(X,{show:E.value,"onUpdate:show":r[3]||(r[3]=I=>E.value=I),txHash:P.value,onClose:g},null,8,["show","txHash"])],64)}}},de=j(Io,[["__scopeId","data-v-28f6b681"]]);const Vo={class:"ave-popup"},To={class:"title"},Ao={class:"body"},Do={class:"info"},Bo={class:"key"},Uo={class:"value"},Fo={key:0,class:"token"},No={key:1,class:"token"},Eo={class:"key"},Ho={class:"value"},Po={class:"key"},Go={class:"value"},Oo={class:"key"},Mo={class:"value"},Yo={__name:"UnlockPopup",props:{show:Boolean,lockId:String,isLockV2:Boolean,isLpToken:Boolean,unlockDate:Number,tokenList:Array,symbol:String,address:String,chainCoinSymbol:String,amountString:String,chain:String,decimals:Number},emits:["update:show","success"],setup(T,{emit:v}){const o=T,{t:S}=J(),C=q(),p=z(),a=m(0n),_=m(0),c=m(!1),A=m("");async function N(){const s=await k.wallet.getGasPrice(),n=await k.wallet.getBalance(C.walletAddress);console.log("balance",n);let u;if(o.isLockV2){const y=await k.wallet.contractTokenLockV2(p.tokenLockV2Address);if(a.value=await y.withdrawFee(),n<a.value){V(S("balanceSlow2",{chainMianCoin:C.chainCoinSymbol,amount:G(a.value)})),v("update:show",!1);return}u=await y.unlock.estimateGas(o.lockId,{value:a.value})}else{const y=await k.wallet.contractTokenLockV3(p.tokenLockV3Address);if(a.value=await y.withdrawFee(),n<a.value){V(S("balanceSlow2",{chainMianCoin:C.chainCoinSymbol,amount:G(a.value)})),v("update:show",!1);return}u=await y.unlock.estimateGas(o.lockId,{value:a.value})}console.dir(u),_.value=G(u*s).toString(),console.log(_.value)}async function E(){const s=x({message:"Loading...",forbidClick:!0,duration:0});if(o.isLockV2)try{const n=await k.wallet.contractTokenLockV2(p.tokenLockV2Address);a.value=await n.withdrawFee();let u=await n.unlock(o.lockId,{value:a.value});console.dir(u),A.value=u.hash,await u.wait(),c.value=!0}catch(n){console.log(n)}finally{s.close()}else try{const n=await k.wallet.contractTokenLockV3(p.tokenLockV3Address);a.value=await n.withdrawFee();let u=await n.unlock(o.lockId,{value:a.value});console.dir(u),A.value=u.hash,await u.wait(),c.value=!0}catch(n){console.log(n)}finally{s.close()}}async function P(){const s=x({message:"Loading...",forbidClick:!0,duration:0});await N(),s.close()}W(()=>o.show,(s,n)=>{s&&P()});function h(){v("update:show",!1),v("success")}return(s,n)=>{const u=H("van-button"),y=H("van-popup");return $(),L(Q,null,[d(y,{show:T.show,"onUpdate:show":n[0]||(n[0]=g=>{v("update:show",g)}),round:"",closeable:"",position:"bottom"},{default:O(()=>[e("div",Vo,[e("div",To,t(s.$t("withdraw")),1),e("div",Ao,[e("ul",Do,[e("li",null,[e("div",Bo,t(s.$t("withdrawAssets")),1),e("div",Uo,[o.isLpToken?($(),L("div",Fo,[d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),f(" "+t(`${o.symbol} (${l(M)(o.address)})`),1)])):($(),L("div",No,[d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.address),chainIcon:l(K)(o.chain)},null,8,["tokenIcon","chainIcon"]),f(" "+t(`${o.symbol} (${l(M)(o.address)})`),1)]))])]),e("li",null,[e("div",Eo,t(s.$t("withdrawNumber")),1),e("div",Ho,[e("span",null,t(s.$t("toBeWithdrawNumber")+": "),1),f(t(T.amountString),1)])]),e("li",null,[e("div",Po,t(s.$t("withdrawFee")),1),e("div",Go,t(`${a.value?l(to).formatEther(a.value):"--"} ${o.chainCoinSymbol}`),1)]),e("li",null,[e("div",Oo,t(s.$t("gas")),1),e("div",Mo,t(`${_.value?_.value:"--"} ${o.chainCoinSymbol}`),1)])]),d(u,{class:"btn",type:"primary",block:"",onClick:E},{default:O(()=>[f(t(s.$t("withdraw")),1)]),_:1})])])]),_:1},8,["show"]),d(X,{show:c.value,"onUpdate:show":n[1]||(n[1]=g=>c.value=g),txHash:A.value,onClose:h},null,8,["show","txHash"])],64)}}},ue=j(Yo,[["__scopeId","data-v-0b712627"]]);const xo={class:"ave-popup"},Ro={class:"title"},jo={class:"body"},qo={class:"info"},zo={class:"key"},Jo={class:"value"},Wo={key:0,class:"token"},Ko={key:1,class:"token"},Qo={class:"key"},Xo={class:"value"},Zo={class:"blue-font"},oe={class:"transfer-address"},ee={class:"key"},te={__name:"TransferPopup",props:{show:Boolean,lockId:String,isLockV2:Boolean,isLpToken:Boolean,unlockDate:Number,tokenList:Array,symbol:String,address:String,chainCoinSymbol:String,amountString:String,chain:String,decimals:Number},emits:["update:show","success"],setup(T,{emit:v}){const o=T,{t:S}=J(),C=q(),p=z();m(0);const a=m(!1),_=m(""),c=m("");function A(){c.value=c.value.trim()}async function N(){if(!so(c.value))return V(S("pleaseEnterTrueAddress")),!1;if(c.value.toLowerCase()==C.walletAddress.toLowerCase())return V(S("transferConsistentOwner")),!1;const h=x({message:"Loading...",forbidClick:!0,duration:0});if(o.isLockV2)try{let n=await(await k.wallet.contractTokenLockV2(p.tokenLockV2Address)).transferLockOwnership(o.lockId,c.value);console.dir(n),_.value=n.hash,await n.wait(),a.value=!0}catch(s){console.log(s)}finally{h.close()}else try{let n=await(await k.wallet.contractTokenLockV3(p.tokenLockV3Address)).transferLockOwnership(o.lockId,c.value);console.dir(n),_.value=n.hash,await n.wait(),a.value=!0}catch(s){console.log(s)}finally{h.close()}}async function E(){}W(()=>o.show,(h,s)=>{h&&E()});function P(){v("update:show",!1),v("success")}return(h,s)=>{const n=H("van-field"),u=H("van-button"),y=H("van-popup");return $(),L(Q,null,[d(y,{show:T.show,"onUpdate:show":s[1]||(s[1]=g=>{v("update:show",g)}),round:"",closeable:"",position:"bottom"},{default:O(()=>[e("div",xo,[e("div",Ro,t(h.$t("withdraw")),1),e("div",jo,[e("ul",qo,[e("li",null,[e("div",zo,t(h.$t("withdrawAssets")),1),e("div",Jo,[o.isLpToken?($(),L("div",Wo,[d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),f(" "+t(`${o.symbol} (${l(M)(o.address)})`),1)])):($(),L("div",Ko,[d(U,{class:"token-icon",tokenIcon:l(F)(o.chain,o.address),chainIcon:l(K)(o.chain)},null,8,["tokenIcon","chainIcon"]),f(" "+t(`${o.symbol} (${l(M)(o.address)})`),1)]))])]),e("li",null,[e("div",Qo,t(h.$t("unlockTime")),1),e("div",Xo,[e("span",null,t(l(B).unix(o.unlockDate).format("YYYY-MM-DD HH:mm:ss")),1),e("span",null,[f("("),e("span",Zo,t(h.$t("dayLeft",{day:l(eo)(l(B).unix(o.unlockDate).toDate())})),1),f(")")])])]),e("li",oe,[e("div",ee,t(h.$t("transferLockedTo")),1),d(n,{class:"owner-address",modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=g=>c.value=g),onBlur:A,placeholder:h.$t("enterReceivingAddress")},null,8,["modelValue","placeholder"])])]),d(u,{class:"btn",type:"primary",block:"",onClick:N},{default:O(()=>[f(t(h.$t("confirmTransfer")),1)]),_:1})])])]),_:1},8,["show"]),d(X,{show:a.value,"onUpdate:show":s[2]||(s[2]=g=>a.value=g),txHash:_.value,onClose:P},null,8,["show","txHash"])],64)}}},re=j(te,[["__scopeId","data-v-2be4d525"]]);export{de as E,re as T,ue as U};
