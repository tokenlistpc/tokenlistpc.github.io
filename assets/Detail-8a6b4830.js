import{B as M}from"./Back-b2de4372.js";import{T as S,C as V}from"./CopyText-c142fa12.js";import{_ as R,h as H,g as q,i as I,r as z,R as F,b,G as P,o as c,c as u,d as t,f as _,H as G,B as g,l,t as s,L as j,z as L,A as T,y as w,F as J,k as m,E as K,I as C,q as x,m as $,p as E,a1 as O}from"./index-1bebee79.js";/* empty css                                                          */import{e as Q}from"./ethers-5d8e554e.js";import"./SelectLockDate-48e247f4.js";/* empty css                                                                */import"./DoubleToken-3b22a8c9.js";import{_ as W}from"./Index-249bcaef.js";import{f as A}from"./units-bc6c6fc9.js";import"./TokenIcon-6cd22654.js";import"./OperateSuccessDialog-e4956a65.js";const X={class:"token-detail"},Z={class:"content"},ee={key:0},te={class:"top"},oe={class:"right"},se={class:"lock-date"},ae={class:"left"},le={class:"right"},ne={class:"left"},ie={class:"right"},ce={key:0},de={class:"left"},re={class:"right"},me={class:"left"},ke={class:"right"},pe={key:0,class:"value"},ue={key:1,class:"value"},_e={class:"left"},ye={class:"right"},he={class:"unlock-date"},fe={class:"left"},ge={class:"right"},we={key:1,class:"operate"},ve={__name:"Detail",props:{lockId:String,tokenType:String},setup(N){const i=N,y=H(),{t:U}=q(),h=I(!1);I(!1);const v=I(!1),e=z({id:i.lockId,address:"",amountString:"",tokenList:[],lockDate:0,unlockDate:0,isLpToken:!1,symbol:"",chain:"",isExpired:!1,chainCoinSymbol:"",decimals:0});async function B(){h.value=!1;let a;i.tokenType=="lpTokenV3"?a=await m.wallet.metamask.contractTokenLockV3(y.lock.tokenLockV3Address):a=await m.wallet.metamask.contractTokenLockV2(y.lock.tokenLockV2Address);let n;try{console.log(i.lockId),n=await a.getLockById(i.lockId)}catch{K({message:U("failedToGetDetail"),type:"error"});return}if(e.lockDate=Number(n[4]),e.unlockDate=Number(n[5]),e.tokenId=n.tokenId,e.address=n[1],e.owner=n[2],e.isExpired=C().unix()>=e.unlockDate,e.chain=y.chain,e.chainCoinSymbol=y.chainCoinSymbol,i.tokenType=="lpToken")try{const o=await m.wallet.metamask.contractLP(e.address);let d=await o.decimals();e.decimals=d;let r=await o.token0(),p=await(await m.wallet.metamask.contractERC20(r)).symbol(),k=await o.token1(),f=await(await m.wallet.metamask.contractERC20(k)).symbol();e.isLpToken=!0,e.tokenList[0]={symbol:p.toUpperCase(),address:r.toLowerCase()},e.tokenList[1]={symbol:f.toUpperCase(),address:k.toLowerCase()},e.amountString=A(n[3],d),e.symbol=`${p}/${f}`}catch(o){console.log(o)}else if(i.tokenType=="token")try{const o=await m.wallet.metamask.contractERC20(e.address);let d=await o.symbol(),r=await o.decimals();e.decimals=r,e.tokenList=[],e.isLpToken=!1,e.symbol=d.toUpperCase(),e.amountString=A(n[3],r)}catch(o){console.log(o)}else if(i.tokenType=="lpTokenV3")try{let d=await(await m.wallet.metamask.contractNFT(e.address)).positions(e.tokenId);console.log(d.token0);let r=d.token0,p=await(await m.wallet.metamask.contractERC20(r)).symbol(),k=d.token1,f=await(await m.wallet.metamask.contractERC20(k)).symbol();e.isLpToken=!0,e.tokenList[0]={symbol:p.toUpperCase(),address:r.toLowerCase()},e.tokenList[1]={symbol:f.toUpperCase(),address:k.toLowerCase()},e.liquidity=d.liquidity,e.symbol=`${p}/${f}`}catch(o){console.log(o)}console.log(e),h.value=!0}return F(()=>{B()}),(a,n)=>{const o=b("el-tag"),d=b("EditPen"),r=b("el-icon"),D=b("el-button"),p=P("loading");return c(),u(J,null,[t("div",X,[_(M),G((c(),u("div",Z,[h.value?(c(),u("ul",ee,[t("li",te,[i.tokenType=="token"?(c(),g(S,{key:0,class:"token-name",name:e.symbol,bigIcon:l(x)(e.chain,e.address.toLocaleLowerCase()),smallIcon:l($)(e.chain)},null,8,["name","bigIcon","smallIcon"])):(c(),g(S,{key:1,class:"token-name",name:e.symbol,token1:l(x)(e.chain,e.tokenList[0].address.toLocaleLowerCase()),token2:l(x)(e.chain,e.tokenList[1].address.toLocaleLowerCase())},null,8,["name","token1","token2"])),t("div",oe,[t("span",se,s(a.$t("unlockTime2"))+"ï¼š"+s(l(C).unix(e.lockDate).format("YYYY-MM-DD HH:mm:ss")),1)])]),t("li",null,[t("div",ae,s(a.$t("contractChian")),1),t("div",le,[_(j,{icon:l($)(e.chain),text:e.chain.toUpperCase()},null,8,["icon","text"])])]),t("li",null,[t("div",ne,s(a.$t("contractAddress")),1),t("div",ie,[_(V,{smallText:l(E)(e.address),text:e.address},null,8,["smallText","text"])])]),i.tokenType=="lpTokenV3"?(c(),u("li",ce,[t("div",de,s(a.$t("tokenID")),1),t("div",re,s(e.id),1)])):L("",!0),t("li",null,[t("div",me,s(a.$t("lockNumber")),1),t("div",ke,[i.tokenType=="lpTokenV3"?(c(),u("div",pe,s(l(Q).formatEther(e.liquidity.toString())),1)):(c(),u("div",ue,s(e.amountString),1))])]),t("li",null,[t("div",_e,s(a.$t("unlockTime2")),1),t("div",ye,[t("div",he,[T(s(l(C).unix(e.unlockDate).format("YYYY-MM-DD HH:mm:ss"))+" ",1),e.isExpired?(c(),g(o,{key:0,class:"over-time tag",size:"small",type:"info"},{default:w(()=>[T(s(a.$t("expired")),1)]),_:1})):(c(),g(o,{key:1,class:"progress tag",size:"small",type:"info"},{default:w(()=>[T(s(a.$t("dayLeft",{day:l(O)(l(C).unix(e.unlockDate).toDate())})),1)]),_:1}))])])]),t("li",null,[t("div",fe,s(a.$t("lockUser")),1),t("div",ge,[_(V,{smallText:l(E)(e.owner),text:e.owner},null,8,["smallText","text"])])])])):L("",!0),!e.isExpired&&h.value&&l(y).walletAddress&&e.owner.toLowerCase()==l(y).walletAddress.toLowerCase()?(c(),u("div",we,[_(D,{class:"btn",text:"",bg:"",type:"primary",onClick:n[0]||(n[0]=k=>v.value=!0)},{icon:w(()=>[_(r,{style:{"font-size":"16px"}},{default:w(()=>[_(d)]),_:1})]),default:w(()=>[T(" "+s(a.$t("edit")),1)]),_:1})])):L("",!0)])),[[p,!h.value]])]),v.value?(c(),g(W,{key:0,modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=k=>v.value=k),lockId:e.id,isLockV2:i.tokenType!=="lpTokenV3",isLpToken:i.tokenType!=="token",unlockDate:e.unlockDate,tokenList:e.tokenList,symbol:e.symbol,address:e.address,amountString:e.amountString,chain:e.chain,decimals:e.decimals},null,8,["modelValue","lockId","isLockV2","isLpToken","unlockDate","tokenList","symbol","address","amountString","chain","decimals"])):L("",!0)],64)}}},Ne=R(ve,[["__scopeId","data-v-47cee6ab"]]);export{Ne as default};
