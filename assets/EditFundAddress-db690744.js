import{_ as $,u as S,d as k,f as B,g as u,N as p,r as f,o as V,c as x,b as L,a as r,l as v,j as w,F as N,q as g,s as n,n as E,A as H,t as O,v as T}from"./index-66fccc80.js";import{u as D}from"./manage-3ae0f00d.js";import{D as I}from"./Dialog-9daba7a7.js";import"./bignumber-3e8dfdf6.js";import"./units-ac5af918.js";/* empty css                                                       */const U={class:"authority-transfer"},j={__name:"EditFundAddress",setup(q){const{t}=S(),h=k(),o=D();B();const a=u(""),d=u(!1),i=u(""),c=u(!1),A=p(()=>h.walletAddress.toLowerCase()===o.owner.toLowerCase()),m=p(()=>o.fundAddress),y=p(()=>t("operationHash",{hash:g(i.value)}));o.$subscribe((e,s)=>{m.value=o.fundAddress});async function C(){if(a.value=a.value.trim(),!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(a.value)){n(t("trueFormat"));return}if(a.value==m.value.toLo){n(t("transferConsistent"));return}d.value=!0;try{const e=await E.wallet.contract(o.tokenAddress,o.abi),s=await e.setFundAddress(a.value);n({type:"success",message:t("submitSuccess")}),i.value=s.hash,c.value=!0,await s.wait(),o.fundAddress=(await e.fundAddress()).toLowerCase(),a.value="",n({type:"success",message:t("upChainSuccessfully")})}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?n(t("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?n(t("userCancelOperate")):n(t("transferFail"))}finally{d.value=!1}}return(e,s)=>{const _=f("van-field"),b=f("van-cell-group"),F=f("van-button");return V(),x(N,null,[L("div",U,[r(b,{inset:""},{default:v(()=>[r(_,{"model-value":w(g)(m.value),"label-width":"11em",disabled:"",label:e.$t("currentFundAddress"),"input-align":"right"},null,8,["model-value","label"])]),_:1}),r(b,{inset:""},{default:v(()=>[r(_,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=l=>a.value=l),label:e.$t("newFundAddress"),"label-width":"9.2em",placeholder:e.$t("input"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(F,{type:"primary",round:"",block:"",class:"btn",loading:d.value,disabled:!A.value,onClick:C},{default:v(()=>[H(O(e.$t("submit")),1)]),_:1},8,["loading","disabled"])]),r(I,{show:c.value,"onUpdate:show":s[1]||(s[1]=l=>c.value=l),title:e.$t("submitSuccess"),message:y.value,showCancelButton:!1,confirmButtonText:e.$t("copyHash"),onOnConfirm:s[2]||(s[2]=l=>w(T)(i.value))},null,8,["show","title","message","confirmButtonText"])],64)}}},P=$(j,[["__scopeId","data-v-095735b6"]]);export{P as default};
