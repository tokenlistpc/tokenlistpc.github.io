import{_ as H,u as j,d as z,a5 as G,g as f,h as J,i as K,r as U,o as r,c as h,a as k,j as l,T as A,A as u,t,m as g,I as y,b as e,k as Y,l as v,F as O,n as p,a6 as Q,B as D,y as F,q as I,z as W,v as P,a4 as X,L as Z,M as oo}from"./index-66fccc80.js";import{E as eo,U as so,T as to}from"./TransferPopup-4faddafd.js";import{e as no}from"./ethers-1c7de5fd.js";import{f as B}from"./units-ac5af918.js";import"./SelectDate-88052b64.js";import"./OperateSuccessDialog-c87d34ba.js";import"./bignumber-3e8dfdf6.js";const ao=_=>(Z("data-v-f35cc33d"),_=_(),oo(),_),io={key:0,class:"body"},lo={key:0,class:"token"},co={key:1,class:"token"},ro={class:"info"},ko={class:"item"},mo={class:"key"},uo={class:"value"},po={key:0,class:"item"},yo={class:"key"},ho={class:"value"},vo={class:"item"},_o={class:"key"},wo={class:"value"},bo={class:"item"},Lo={class:"key"},fo={key:0,class:"value"},Co={key:1,class:"value"},So={class:"item"},go={class:"key"},Do={class:"value"},Io={class:"blue-font"},To={class:"item"},$o={class:"key"},Vo={class:"value"},Eo={class:"item"},Uo={class:"key"},Ao={class:"value"},Fo=ao(()=>e("div",{class:"footer"},null,-1)),No={__name:"Detail",props:{lockId:String,tokenType:String,version:String},setup(_){const n=_,{t:M}=j(),C=z(),N=G(),S=f(!1),o=J({id:n.lockId,address:"",amountString:"",tokenList:[],lockDate:0,unlockDate:0,isLpToken:!1,symbol:"",chain:"",isExpired:!1,chainCoinSymbol:"",decimals:0}),T=f(!1),$=f(!1),V=f(!1);async function R(){S.value=!1;let i;n.version=="V2"?i=await p.wallet.contractTokenLockV2(N.tokenLockV2Address):n.version=="V3"&&(i=await p.wallet.contractTokenLockV3(N.tokenLockV3Address)),console.dir(i);let s;try{console.log(n.lockId),s=await i.getLockById(n.lockId)}catch{Q(M("failedToGetDetail"));return}if(o.lockDate=Number(s[4]),o.unlockDate=Number(s[5]),o.tokenId=s.tokenId,o.address=s[1],o.owner=s[2],o.isExpired=D().unix()>=o.unlockDate,o.chain=C.chain,o.chainCoinSymbol=C.chainCoinSymbol,n.tokenType=="lpToken"){if(n.version=="V2")try{const a=await p.wallet.contractLP(o.address);let c=await a.decimals();o.decimals=c;let m=await a.token0(),w=await(await p.wallet.contractERC20(m)).symbol(),b=await a.token1(),L=await(await p.wallet.contractERC20(b)).symbol();o.isLpToken=!0,o.tokenList[0]={symbol:w.toUpperCase(),address:m.toLowerCase()},o.tokenList[1]={symbol:L.toUpperCase(),address:b.toLowerCase()},o.amountString=B(s[3],c),o.symbol=`${w}/${L}`}catch(a){console.log(a)}else if(n.version=="V3")try{let c=await(await p.wallet.contractNFT(o.address)).positions(o.tokenId);console.log(c.token0);let m=c.token0,w=await(await p.wallet.contractERC20(m)).symbol(),b=c.token1,L=await(await p.wallet.contractERC20(b)).symbol();o.isLpToken=!0,o.tokenList[0]={symbol:w.toUpperCase(),address:m.toLowerCase()},o.tokenList[1]={symbol:L.toUpperCase(),address:b.toLowerCase()},o.liquidity=c.liquidity,o.symbol=`${w}/${L}`}catch(a){console.log(a)}}else if(n.tokenType=="token")try{const a=await p.wallet.contractERC20(o.address);let c=await a.symbol(),m=await a.decimals();o.decimals=m,o.tokenList=[],o.isLpToken=!1,o.symbol=c.toUpperCase(),o.amountString=B(s[3],m)}catch(a){console.log(a)}S.value=!0,console.log("getDetailDone")}function q(){console.log(o),T.value=!0}function E(){window.location.reload()}return K(()=>{R()}),f(!0),console.log(n.lockId),console.log(n.tokenType),(i,s)=>{const a=U("van-icon"),c=U("van-button"),m=U("van-action-bar");return r(),h(O,null,[S.value?(r(),h("div",io,[o.isLpToken?(r(),h("div",lo,[k(A,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),k(A,{class:"token-icon",tokenIcon:l(F)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),u(" "+t(`${o.symbol} (${l(I)(o.address)})`),1)])):(r(),h("div",co,[o.address?(r(),g(A,{key:0,class:"token-icon",tokenIcon:l(F)(o.chain,o.address.toLowerCase()),chainIcon:l(W)(o.chain)},null,8,["tokenIcon","chainIcon"])):y("",!0),u(" "+t(`${o.symbol} (${l(I)(o.address)})`),1)])),e("ul",ro,[e("li",ko,[e("div",mo,t(i.$t("contractAddress")),1),e("div",uo,[u(t(l(I)(o.address))+" ",1),k(Y,{class:"copy-icon",name:"copy",onClick:s[0]||(s[0]=d=>l(P)(o.address))})])]),n.version=="V3"?(r(),h("li",po,[e("div",yo,t(i.$t("tokenID")),1),e("div",ho,t(n.lockId),1)])):y("",!0),e("li",vo,[e("div",_o,t(i.$t("contractChian")),1),e("div",wo,t(o.chain.toUpperCase()),1)]),e("li",bo,[e("div",Lo,t(`${o.symbol} ${i.$t("lockNumber")}`),1),n.version=="V2"?(r(),h("div",fo,t(o.amountString),1)):y("",!0),n.version=="V3"?(r(),h("div",Co,t(l(no).formatEther(o.liquidity.toString())),1)):y("",!0)]),e("li",So,[e("div",go,t(i.$t("unlockTime2")),1),e("div",Do,[e("span",null,t(l(D).unix(o.unlockDate).format("YYYY-MM-DD HH:mm:ss")),1),e("span",null,[u("("),e("span",Io,t(o.isExpired?i.$t("expired"):i.$t("dayLeft",{day:l(X)(l(D).unix(o.unlockDate).toDate())})),1),u(")")])])]),e("li",To,[e("div",$o,t(i.$t("lockUser")),1),e("div",Vo,[u(t(l(I)(o.owner))+" ",1),k(Y,{class:"copy-icon",name:"copy",onClick:s[1]||(s[1]=d=>l(P)(o.owner))})])]),e("li",Eo,[e("div",Uo,t(i.$t("lockTime")),1),e("div",Ao,t(l(D).unix(o.lockDate).format("YYYY-MM-DD HH:mm:ss")),1)])])])):y("",!0),Fo,S.value&&l(C).walletAddress&&o.owner.toLowerCase()==l(C).walletAddress.toLowerCase()?(r(),g(m,{key:1,class:"tools"},{default:v(()=>[o.isExpired?y("",!0):(r(),g(c,{key:0,class:"btn",color:"#9F3FF7",onClick:q},{icon:v(()=>[k(a,{name:"edit"})]),default:v(()=>[u(t(i.$t("edit")),1)]),_:1})),o.isExpired?(r(),g(c,{key:1,class:"btn",color:"#3F80F7",onClick:s[2]||(s[2]=d=>$.value=!0)},{icon:v(()=>[k(a,{name:"after-sale"})]),default:v(()=>[u(t(i.$t("withdraw")),1)]),_:1})):y("",!0),k(c,{class:"btn",color:"#3F80F7",onClick:s[3]||(s[3]=d=>V.value=!0)},{icon:v(()=>[k(a,{name:"arrow"})]),default:v(()=>[u(t(i.$t("transfer")),1)]),_:1}),k(eo,{show:T.value,"onUpdate:show":s[4]||(s[4]=d=>T.value=d),onSuccess:E,isLockV2:n.version=="V2",lockId:o.id,isLpToken:o.isLpToken,chain:o.chain,unlockDate:o.unlockDate,tokenList:o.tokenList,symbol:o.symbol,address:o.address,chainCoinSymbol:o.chainCoinSymbol,amountString:o.amountString,decimals:o.decimals},null,8,["show","isLockV2","lockId","isLpToken","chain","unlockDate","tokenList","symbol","address","chainCoinSymbol","amountString","decimals"]),k(so,{show:$.value,"onUpdate:show":s[5]||(s[5]=d=>$.value=d),onSuccess:E,isLockV2:n.version=="V2",lockId:o.id,isLpToken:o.isLpToken,chain:o.chain,unlockDate:o.unlockDate,tokenList:o.tokenList,symbol:o.symbol,address:o.address,chainCoinSymbol:o.chainCoinSymbol,amountString:o.amountString,decimals:o.decimals},null,8,["show","isLockV2","lockId","isLpToken","chain","unlockDate","tokenList","symbol","address","chainCoinSymbol","amountString","decimals"]),k(to,{show:V.value,"onUpdate:show":s[6]||(s[6]=d=>V.value=d),onSuccess:E,isLockV2:n.version=="V2",lockId:o.id,isLpToken:o.isLpToken,chain:o.chain,unlockDate:o.unlockDate,tokenList:o.tokenList,symbol:o.symbol,address:o.address,chainCoinSymbol:o.chainCoinSymbol,amountString:o.amountString,decimals:o.decimals},null,8,["show","isLockV2","lockId","isLpToken","chain","unlockDate","tokenList","symbol","address","chainCoinSymbol","amountString","decimals"])]),_:1})):y("",!0)],64)}}},Ho=H(No,[["__scopeId","data-v-f35cc33d"]]);export{Ho as default};
