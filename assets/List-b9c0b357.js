import{_ as V}from"./noData-cd778682.js";import{T as z}from"./CopyText.vuevuetypestyleindex0scoped0a79820blang-cc8752a4.js";import{C as v}from"./CopyText-090b2ebf.js";import{_ as Y,i as j,s as x,r as T,h as E,a as H,u as M,b as O,w as W,d as f,H as P,o as r,c as u,e as y,A as k,t as l,l as m,B as h,y as i,I as U,g as a,E as q,k as $,q as J,m as G,z as K,p as I,J as Q}from"./index-d569c10e.js";import"./TokenIcon-7ae3eded.js";/* empty css                                                          */import"./DoubleToken-25a2ddca.js";const X={class:"token-list"},Z={key:0,class:"empty"},ee=["fit"],te={class:"info"},oe={key:1,class:"list"},ae={key:0},ne={key:1},se={key:2},re={key:3},le={class:"pagination"},ie={__name:"List",setup(ce){const n=j(),N=x(),_=T(0),g=T(10),{t:A}=E();H();const C=M(),o=O({pageNumber:1,tokenList:[],loading:!1});async function L(){try{let s=await(await $.wallet.metamask.contractTokenFactory(n.create.tokenFactoryAddress)).totalOwnRecordsForUser(n.walletAddress);_.value=Number(s)}catch(e){console.error(e)}}async function w(){if(console.log("111"),!n.walletAddress){q.error(A("pleaseConnectWallet")),o.loading=!1;return}o.loading=!0;let e=((o.pageNumber-1)*g.value).toString(),s=((o.pageNumber-1)*g.value+g.value-1).toString();try{if(await L(),_.value==0)throw"err";let c=await(await $.wallet.metamask.contractTokenFactory(n.create.tokenFactoryAddress)).getOwnRecords(n.walletAddress,e,s);console.log(c),o.tokenList=[];for(let d of c){let b={tokenAddress:d[6].toLowerCase(),createTime:Number(d[0]),symbol:d[4],name:d[3],chain:n.chain,deployerId:Number(d[5]),owner:d[2]};o.tokenList.push(b)}console.log(o.tokenList)}catch(p){console.log(p)}finally{o.loading=!1}}W(()=>n.isConnecting,e=>{e&&(console.log(222),w())},{immediate:!0});function D(){w()}function F(){N.loginDialogVisible=!0}function R(){C.push("/token/create")}function S(e){C.push(`/token/manage/${e.deployerId}/${e.chain}/${e.tokenAddress}`)}return(e,s)=>{const p=f("el-button"),c=f("el-table-column"),d=f("el-table"),b=f("el-pagination"),B=P("loading");return r(),u("div",X,[!o.loading&&o.tokenList.length==0?(r(),u("div",Z,[y("img",{style:{width:"80px"},src:V,fit:e.fit},null,8,ee),y("div",te,[k(l(e.$t("noToken"))+"ï¼Œ",1),y("span",{onClick:w,style:{color:"#409eff",cursor:"pointer"}},l(e.$t("refresh")),1)]),m(n).isConnecting?(r(),h(p,{key:0,type:"primary",class:"btn-gradient create",onClick:s[0]||(s[0]=t=>R())},{default:i(()=>[k(l(e.$t("tokenCreate")),1)]),_:1})):(r(),h(p,{key:1,type:"primary",class:"btn-gradient create",onClick:s[1]||(s[1]=t=>F())},{default:i(()=>[k(l(e.$t("connectWallet")),1)]),_:1}))])):(r(),u("div",oe,[U((r(),h(d,{class:"table-mine",data:o.tokenList},{default:i(()=>[a(c,{prop:"tokenName",label:e.$t("tokenName"),width:"150"},{default:i(t=>[a(z,{class:"token-name",symbol:t.row.symbol,name:t.row.name,bigIcon:m(J)(m(n).chain.toLowerCase(),t.row.tokenAddress.toLowerCase()),smallIcon:m(G)(m(n).chain.toLowerCase())},null,8,["symbol","name","bigIcon","smallIcon"])]),_:1},8,["label"]),a(c,{prop:"amount",label:e.$t("template"),width:"150"},{default:i(t=>[t.row.deployerId==0?(r(),u("span",ae,l(e.$t("freeTax")),1)):t.row.deployerId==1?(r(),u("span",ne,l(e.$t("feeToken")),1)):t.row.deployerId==2?(r(),u("span",se,l(e.$t("selfDividendToken")),1)):t.row.deployerId==3?(r(),u("span",re,l(e.$t("addPoolDividend")),1)):K("",!0)]),_:1},8,["label"]),a(c,{prop:"amount",label:e.$t("managerAddress")},{default:i(t=>[a(v,{text:t.row.owner,smallText:m(I)(t.row.owner)},null,8,["text","smallText"])]),_:1},8,["label"]),a(c,{prop:"amount",label:e.$t("tokenAddress")},{default:i(t=>[a(v,{text:t.row.tokenAddress,smallText:m(I)(t.row.tokenAddress)},null,8,["text","smallText"])]),_:1},8,["label"]),a(c,{prop:"unlockDate",label:e.$t("createTime")},{default:i(t=>[k(l(m(Q).unix(t.row.createTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),a(c,{prop:"address",label:e.$t("operate"),width:"90"},{default:i(t=>[a(p,{key:"primary",type:"primary",onClick:de=>S(t.row),link:""},{default:i(()=>[k(l(e.$t("view")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[B,o.loading]]),y("div",le,[a(b,{background:"",layout:"prev, pager, next",total:_.value,onCurrentChange:D,"page-size":g.value,"current-page":o.pageNumber,"onUpdate:currentPage":s[2]||(s[2]=t=>o.pageNumber=t)},null,8,["total","page-size","current-page"])])]))])}}},_e=Y(ie,[["__scopeId","data-v-f1033f59"]]);export{_e as default};
