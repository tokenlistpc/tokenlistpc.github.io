import{_ as N,d as A,a7 as B,g as i,N as F,G as V,i as D,r as h,o as l,m,l as v,p as U,n as Y,a as w,k as E,b as o,t as n,c as y,x as R,j as _,z as j,y as z,T as q,A as C,B as G,q as W,F as J,D as K,a6 as O}from"./index-66fccc80.js";import{e as P}from"./ethers-1c7de5fd.js";import"./units-ac5af918.js";const Q={class:"text"},X={class:"item-left"},Z={class:"left-content"},ee={key:0,class:"status finish"},te={key:1,class:"status fail"},se={key:2,class:"status wait"},ae={class:"bottom-text"},ne={class:"item-right"},oe={class:"bottom-text"},le={__name:"History",setup(re){const x=A(),d=B(),c=i(!1),k=i(!1),H=i(!1),u=i(!1),p=i([]),L=i(15),$=i(1),b=F(()=>d.transferringList.concat(p.value));function T(){c.value=!1,H.value=!1,u.value=!1,$.value=1,p.value=[],g()}async function g(){c.value=!0;let s=U({message:"Loading...",forbidClick:!0,duration:0});try{const a=await Y.multiSend.getMultiSendHistory(x.walletAddress,L.value,$.value,x.chain);if(console.log(a),a.data.status==0){if(p.value=p.value.concat(a.data.data.list),d.transferringList.length>0&&a.data.data.list.length>0)for(let r in d.transferringList)a.data.data.list.find(f=>f.txHash==d.transferringList[r].txHash)&&d.transferringList.splice(r,1);a.data.data.list.length<L.value?H.value=!0:$.value++}else u.value=!0}catch(a){console.log(a),u.value=!0}finally{s.close(),k.value=!1,c.value=!1}}function I(s,a){let r=K.chainList.find(f=>f.chain==s);r?window.open(r.txBlockExplorerUrl+a,"_blank"):O(t("unsupportedNetwork"))}return V(()=>x.walletAddress,(s,a)=>{s&&g()}),D(()=>{g()}),(s,a)=>{const r=h("van-empty"),f=h("van-cell"),S=h("van-list"),M=h("van-pull-refresh");return l(),m(M,{class:"transfer-list-box",modelValue:k.value,"onUpdate:modelValue":a[2]||(a[2]=e=>k.value=e),"pulling-text":s.$t("pulling"),"loosing-text":s.$t("loosing"),"loading-text":s.$t("loading"),onRefresh:T},{default:v(()=>[b.value.length==0?(l(),m(r,{key:0,class:"empty-box"},{image:v(()=>[w(E,{class:"icon",name:"emptyHistory"}),o("div",Q,n(s.$t("noRecord")),1)]),_:1})):(l(),m(S,{key:1,class:"transfer-list",loading:c.value,"onUpdate:loading":a[0]||(a[0]=e=>c.value=e),"loading-text":s.$t("loading"),finished:H.value,"finished-text":s.$t("noMore"),error:u.value,"onUpdate:error":a[1]||(a[1]=e=>u.value=e),"error-text":s.$t("errorText"),onLoad:g},{default:v(()=>[(l(!0),y(J,null,R(b.value,e=>(l(),m(f,{class:"transfer-item",key:e,onClick:ie=>I(e.chain,e.txHash)},{title:v(()=>[o("div",X,[w(q,{chainIcon:_(j)(e.chain),tokenIcon:_(z)(e.chain,e.tokenAddress.toLowerCase())},null,8,["chainIcon","tokenIcon"]),o("div",Z,[o("div",null,[C(n(_(P).formatEther(e.sendAmount))+" "+n(e.tokenSymbol)+" ",1),e.status==0?(l(),y("span",ee,n(s.$t("transferFinish")),1)):e.status==1?(l(),y("span",te,n(s.$t("mulTransferFail")),1)):(l(),y("span",se,n(s.$t("transferWait")),1))]),o("div",ae,n(_(G).unix(e.sendTime).format("YYYY-MM-DD HH:mm")),1)])])]),value:v(()=>[o("div",ne,[o("div",null,n(s.$t("addressCount"))+": "+n(e.receiverCount),1),o("div",oe,[C(n(s.$t("txHash"))+": ",1),o("span",null,n(_(W)(e.txHash)),1)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["loading","loading-text","finished","finished-text","error","error-text"]))]),_:1},8,["modelValue","pulling-text","loosing-text","loading-text"])}}},fe=N(le,[["__scopeId","data-v-1bce8044"]]);export{fe as default};
